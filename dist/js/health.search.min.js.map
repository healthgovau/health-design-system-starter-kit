{"version":3,"sources":["health.search.js"],"names":["health","$","healthSearchResize","window","width","length","insertAfter","show","removeClass","hide","hasClass","addClass","searchAutocomplete","selector","source","once","autocomplete","minLength","classes","select","event","ui","this","val","item","value","target","parents","submit","search","find","toggleClass","response","facetShowMore","limit","each","limit_css","facet","filter","attr","text","click","document","ready","resizeTimer","resize","clearTimeout","setTimeout","clone","e","toggle","jQuery"],"mappings":"AAAA,IAAIA,OAASA,QAAU,IAEvB,SAAWC,GAsCT,SAASC,IAEHD,EAAEE,QAAQC,QAAU,KACkC,IAApDH,EAAE,uCAAuCI,QAC3CJ,EAAE,0BAA0BK,YAAY,mBAAmBC,OAE7DN,EAAE,iBAAiBO,YAAY,iCAIyB,IAApDP,EAAE,uCAAuCI,QAC3CJ,EAAE,0BAA0BK,YAAY,qBAAqBG,OAG1DR,EAAE,kBAAkBS,SAAS,wBAChCT,EAAE,iBAAiBU,SAAS,gCAzClCX,OAAOY,mBAAqB,SAAUC,EAAUC,GAC9Cb,EAAEY,GAAUE,KAAK,4BAA4BC,aAAa,CACxDF,OAAQA,EACRG,UAAW,EACXC,QAAS,CACP,kBAAmB,wBAGrBC,OAAQ,SAAUC,EAAOC,GACvBpB,EAAEqB,MAAMC,IAAIF,EAAGG,KAAKC,OACpBxB,EAAEmB,EAAMM,QAAQC,QAAQ,QAAQC,UAGlCC,OAAQ,SAAUT,EAAOC,GACvBpB,EAAEmB,EAAMM,QAAQC,QAAQ,QAAQG,KAAK,mBAAmBC,YAAY,2BAGtEC,SAAU,SAAUZ,EAAOC,GACzBpB,EAAEmB,EAAMM,QAAQC,QAAQ,QAAQG,KAAK,mBAAmBC,YAAY,8BAkC1E/B,OAAOiC,cAAgB,SAAUpB,EAAUqB,GACzCjC,EAAEY,GAAUE,KAAK,uBAAuBoB,MAAK,WAC3C,IACEC,EAAYF,EAAQ,EACpBG,EAAQpC,EAAEqB,MAGZe,EAAMP,KAAK,wBAA0BM,EAAY,KAAK3B,OAGtD4B,EAAMC,QAAO,WACX,OAAOD,EAAMP,KAAK,qBAAqBzB,OAAS6B,KAC/CC,MAAK,WACNlC,EAAE,0BAA4BoC,EAAME,KAAK,MAAQ,yDAAyDC,KAAK,aAAaC,OAAM,WAQhI,OAPIJ,EAAMP,KAAK,4BAA4BzB,OAAS,GAClDgC,EAAMP,KAAK,wBAA0BM,EAAY,KAAK7B,OACtDN,EAAEqB,MAAMX,SAAS,QAAQ6B,KAAK,eAE9BH,EAAMP,KAAK,wBAA0BM,EAAY,KAAK3B,OACtDR,EAAEqB,MAAMd,YAAY,QAAQgC,KAAK,eAE5B,KACNlC,YAAY+B,EAAMP,KAAK,+BAKhC7B,EAAEyC,UAAUC,OAAM,WAEhB,IAAIC,EAEJ3C,EAAEE,QAAQ0C,QAAO,WACfC,aAAaF,GACbA,EAAcG,WAAW7C,EAAoB,QAE/CA,IAIAD,EAAE,sCAAsC+C,QAAQ1C,YAAY,mCAAmCK,SAAS,4BAGxGV,EAAE,gCAAgCwC,OAAM,SAAUQ,GAChDhD,EAAE,0BAA0BiD,SAC5BjD,EAAEqB,MAAMQ,KAAK,uBAAuBoB,YAItCjD,EAAE,kBAAkBwC,OAAM,SAAUQ,GAClChD,EAAEqB,MAAMS,YAAY,uBACpB9B,EAAE,iBAAiB8B,YAAY,kCAIjC9B,EAAE,qEAAqEU,SAAS,gBAtHpF,CA0HGwC","file":"health.search.min.js","sourcesContent":["var health = health || {};\n\n(function ($) {\n\n  /**\n   * Add an autocomplete dropdown to a text input.\n   *\n   * @param selector\n   *   jQuery selector.\n   * @param source\n   *   Callback function or array of terms.\n   *\n   * @see https://api.jqueryui.com/autocomplete/\n   */\n  health.searchAutocomplete = function (selector, source) {\n    $(selector).once('healthSearchAutocomplete').autocomplete({\n      source: source,\n      minLength: 2,\n      classes: {\n        \"ui-autocomplete\": \"au-body au-link-list\"\n      },\n      // When the user selects a value, submit the form.\n      select: function (event, ui) {\n        $(this).val(ui.item.value);\n        $(event.target).parents('form').submit();\n      },\n      // Show loading spinner.\n      search: function (event, ui) {\n        $(event.target).parents('form').find('.health-loading').toggleClass('health-loading--active');\n      },\n      // Hide loading spinner.\n      response: function (event, ui) {\n        $(event.target).parents('form').find('.health-loading').toggleClass('health-loading--active');\n      }\n    });\n  };\n\n  /**\n   * Move the search box depending on if we are looking at mobile or desktop.\n   */\n  function healthSearchResize() {\n    // Desktop\n    if ($(window).width() > 769) {\n      if ($('.au-main-nav .health-search--global').length !== 0) {\n        $('.health-search--global').insertAfter('.health-sub-nav').show();\n      }\n      $('.health-facet').removeClass('health-facet--mobile-hidden');\n    }\n    // Mobile\n    else {\n      if ($('.au-main-nav .health-search--global').length === 0) {\n        $('.health-search--global').insertAfter('#main-nav-default').hide();\n      }\n      // If mobile filters are closed, then hide the facets.\n      if (!$('.health-filter').hasClass('health-filter--open')) {\n        $('.health-facet').addClass('health-facet--mobile-hidden');\n      }\n    }\n  }\n\n  /**\n   * Limit the number of options displayed in a facet group by providing a show more and show less link.\n   *\n   * @param selector\n   * @param limit\n   */\n  health.facetShowMore = function (selector, limit) {\n    $(selector).once('healthFacetShowMore').each(function () {\n      var\n        limit_css = limit - 1,\n        facet = $(this);\n\n      // Hide filters beyond the limit.\n      facet.find('.au-control-input:gt(' + limit_css + ')').hide();\n\n      // Add a 'Show more' button if the facet has more than the limit.\n      facet.filter(function () {\n        return facet.find('.au-control-input').length > limit;\n      }).each(function () {\n        $('<button aria-controls=\"' + facet.attr('id') + '\" class=\"health-facet__more au-btn au-btn--tertiary\">').text('Show more').click(function () {\n          if (facet.find('.au-control-input:hidden').length > 0) {\n            facet.find('.au-control-input:gt(' + limit_css + ')').show();\n            $(this).addClass('open').text('Show less');\n          } else {\n            facet.find('.au-control-input:gt(' + limit_css + ')').hide();\n            $(this).removeClass('open').text('Show more');\n          }\n          return false;\n        }).insertAfter(facet.find('.health-facet__list'));\n      });\n    });\n  };\n\n  $(document).ready(function () {\n\n    var resizeTimer; // Set resizeTimer to empty so it resets on page load\n    // On resize, run the function and reset the timeout\n    $(window).resize(function () {\n      clearTimeout(resizeTimer);\n      resizeTimer = setTimeout(healthSearchResize, 250);\n    });\n    healthSearchResize();\n\n    // Copy across the elements from the sub menu into the main nav.\n    // Only show them in the mobile menu.\n    $('.health-sub-nav ul.au-link-list li').clone().insertAfter('.au-main-nav ul li:last-of-type').addClass('au-main-nav--mobile-only');\n\n    // Search button handler.\n    $('.au-main-nav__toggle--search').click(function (e) {\n      $('.health-search--global').toggle();\n      $(this).find('span.svg-inline--fa').toggle();\n    });\n\n    // Filter toggles.\n    $('.health-filter').click(function (e) {\n      $(this).toggleClass('health-filter--open');;\n      $('.health-facet').toggleClass('health-facet--mobile-hidden');\n    });\n\n    // Add correct grid class to second refine search in listings.\n    $('.region-navigation #search-api-page-search-form-default-search--2').addClass('col-xs-12');\n\n  });\n\n})(jQuery);\n"]}